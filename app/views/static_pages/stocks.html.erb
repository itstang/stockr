<h1>Stocks list</h1>

<!-- Search -->
<%= form_tag(stocks_path, :method => "get", class: "navbar-form", id: "search-form") do %>
    <div class="input-append">
      <%= text_field_tag :search, params[:search], class: "span2", placeholder: "Search Symbols" %>

      <button class="btn btn-primary" type="submit"><i class="icon-search"></i>Search</button>
    </div>
<% end %>
<%= yield %>

<!-- Stock table -->
<table class="table table-striped">
  <thead>
    <tr>
      <th>Symbol</th>
      <th>Company Name</th>
    </tr>
  </thead>
  <tbody>
    <% if (params[:search] == '') || (params[:search].nil?) %>
      <% @stocks.each do |stock| %>
        <tr>
          <td><%= link_to stock.symbol, stock_path(stock.id)  %></td>
          <td><%= stock.company %></td>
        </tr>
      <% end %>
      <%= will_paginate @stocks%>
    <% else%>
      <% @stocks.where(symbol: params[:search].upcase).each do |stock| %>
        <tr>
          <td><%= link_to stock.symbol, stock_path(stock.id)  %></td>
          <td><%= stock.company %></td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
